--------------
select sumDistinct(number) from ( select number % 100 as number from numbers(100000))
--------------

+---------------------+
| sumDistinct(number) |
+---------------------+
|                4950 |
+---------------------+
--------------
select countDistinct(number) from ( select number % 100 as number from numbers(100000))
--------------

+-----------------------+
| countDistinct(number) |
+-----------------------+
|                   100 |
+-----------------------+
--------------
select sumDistinct(number) /  countDistinct(number) = avgDistinct(number) from ( select number % 100 as number from numbers(100000))
--------------

+-----------------------------------------------------------------------+
| ((sumDistinct(number) / countDistinct(number)) = avgDistinct(number)) |
+-----------------------------------------------------------------------+
|                                                                  true |
+-----------------------------------------------------------------------+
--------------
select sumIf(number, number >= 100000 - 1) from numbers(100000)
--------------

+-----------------------------------------+
| sumIf(number, (number >= (100000 - 1))) |
+-----------------------------------------+
|                                   99999 |
+-----------------------------------------+
--------------
select sumIf(number, number > 100) /  countIf(number,  number > 100) = avgIf(number,  number > 100) from numbers(100000)
--------------

+-----------------------------------------------------------------------------------------------------+
| ((sumIf(number, (number > 100)) / countIf(number, (number > 100))) = avgIf(number, (number > 100))) |
+-----------------------------------------------------------------------------------------------------+
|                                                                                                true |
+-----------------------------------------------------------------------------------------------------+
